<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.platform.ems.mapper.CosProductCostBomMapper"> 
  <resultMap type="com.platform.ems.domain.CosProductCostBom" id="CosProductCostBomResult"> 
    <result property="clientId" column="client_id"/>  
    <result property="productCostBomSid" column="product_cost_bom_sid"/>  
    <result property="productCostSid" column="product_cost_sid"/>  
    <result property="bomSid" column="bom_sid"/>  
    <result property="materialSid" column="material_sid"/>  
    <result property="sku1Sid" column="sku1_sid"/>  
    <result property="sku2Sid" column="sku2_sid"/>  
    <result property="bomVersionId" column="bom_version_id"/>  
    <result property="bomVersionDateGet" column="bom_version_date_get"/>  
    <result property="bomVersionNameGet" column="bom_version_name_get"/>  
    <result property="remark" column="remark"/>  
    <result property="creatorAccount" column="creator_account"/>  
    <result property="createDate" column="create_date"/>  
    <result property="updaterAccount" column="updater_account"/>  
    <result property="updateDate" column="update_date"/>  
    <result property="confirmerAccount" column="confirmer_account"/>  
    <result property="confirmDate" column="confirm_date"/>  
    <result property="dataSourceSys" column="data_source_sys"/> 
  </resultMap>  
  <sql id="selectCosProductCostBomVo">select t.client_id, t.product_cost_bom_sid, t.product_cost_sid, t.bom_sid, t.material_sid, t.sku1_sid, t.sku2_sid, t.bom_version_id, t.bom_version_date_get, t.bom_version_name_get, t.remark, t.creator_account, t.create_date, t.updater_account, t.update_date, t.confirmer_account, t.confirm_date, t.data_source_sys from s_cos_product_cost_bom t</sql>  
  <select id="selectCosProductCostBomById" parameterType="Long" resultMap="CosProductCostBomResult"> 
    <include refid="selectCosProductCostBomVo"/> where t.product_cost_bom_sid = #{productCostBomSid}
  </select>  
  <select id="selectCosProductCostBomList" parameterType="com.platform.ems.domain.CosProductCostBom" resultMap="CosProductCostBomResult"> 
    <include refid="selectCosProductCostBomVo"/>  
    <where> 
      <if test="clientId != null  and clientId != ''">and (
        <foreach collection="clientId.split(';')" item="item" separator="or">t.client_id like concat('%', #{item}, '%')</foreach>)
      </if>  
      <if test="productCostSid != null ">and t.product_cost_sid in (
        <foreach collection="productCostSid" item="item" separator=",">#{item}</foreach>)
      </if>  
      <if test="bomSid != null ">and t.bom_sid in (
        <foreach collection="bomSid" item="item" separator=",">#{item}</foreach>)
      </if>  
      <if test="materialSid != null ">and t.material_sid in (
        <foreach collection="materialSid" item="item" separator=",">#{item}</foreach>)
      </if>  
      <if test="sku1Sid != null ">and t.sku1_sid in (
        <foreach collection="sku1Sid" item="item" separator=",">#{item}</foreach>)
      </if>  
      <if test="sku2Sid != null ">and t.sku2_sid in (
        <foreach collection="sku2Sid" item="item" separator=",">#{item}</foreach>)
      </if>  
      <if test="bomVersionId != null ">and t.bom_version_id in (
        <foreach collection="bomVersionId" item="item" separator=",">#{item}</foreach>)
      </if>  
      <if test="bomVersionDateGet != null ">and t.bom_version_date_get = #{bomVersionDateGet}</if>  
      <if test="bomVersionNameGet != null  and bomVersionNameGet != ''">and (
        <foreach collection="bomVersionNameGet.split(';')" item="item" separator="or">t.bom_version_name_get like concat('%', #{item}, '%')</foreach>)
      </if>  
      <if test="creatorAccount != null  and creatorAccount != ''">and (
        <foreach collection="creatorAccount.split(';')" item="item" separator="or">t.creator_account like concat('%', #{item}, '%')</foreach>)
      </if>  
      <if test="beginTime != null and beginTime!=''">and date_format(t.create_date,'%y%m%d') &gt;= date_format(#{beginTime},'%y%m%d')</if>  
      <if test="endTime != null and endTime!=''">and date_format(t.create_date,'%y%m%d') &lt;= date_format(#{endTime},'%y%m%d')</if>  
      <if test="updaterAccount != null  and updaterAccount != ''">and (
        <foreach collection="updaterAccount.split(';')" item="item" separator="or">t.updater_account like concat('%', #{item}, '%')</foreach>)
      </if>  
      <if test="updateDate != null ">and t.update_date = #{updateDate}</if>  
      <if test="confirmerAccount != null  and confirmerAccount != ''">and (
        <foreach collection="confirmerAccount.split(';')" item="item" separator="or">t.confirmer_account like concat('%', #{item}, '%')</foreach>)
      </if>  
      <if test="confirmDate != null ">and t.confirm_date = #{confirmDate}</if>  
      <if test="dataSourceSys != null  and dataSourceSys != ''">and (
        <foreach collection="dataSourceSys.split(';')" item="item" separator="or">t.data_source_sys like concat('%', #{item}, '%')</foreach>)
      </if> 
    </where> 
  </select>  
  <!--添加多个-->  
  <insert id="inserts">insert into s_cos_product_cost_bom 
    <trim prefix="(" suffix=")" suffixOverrides=",">client_id, product_cost_bom_sid, product_cost_sid, bom_sid, material_sid, sku1_sid, sku2_sid, bom_version_id, bom_version_date_get, bom_version_name_get, remark, creator_account, create_date, updater_account, update_date, confirmer_account, confirm_date, data_source_sys,</trim>  
    <trim prefix="values (" suffix=")" suffixOverrides=","> 
      <foreach collection="list" item="o" separator=",">#{clientId}, #{productCostBomSid}, #{productCostSid}, #{bomSid}, #{materialSid}, #{sku1Sid}, #{sku2Sid}, #{bomVersionId}, #{bomVersionDateGet}, #{bomVersionNameGet}, #{remark}, #{creatorAccount}, #{createDate}, #{updaterAccount}, #{updateDate}, #{confirmerAccount}, #{confirmDate}, #{dataSourceSys},</foreach> 
    </trim> 
  </insert>  
  <!--更新-->  
  <update id="updateAllById">update s_cos_product_cost_bom 
    <trim prefix="SET" suffixOverrides=",">client_id = #{clientId}, product_cost_sid = #{productCostSid}, bom_sid = #{bomSid}, material_sid = #{materialSid}, sku1_sid = #{sku1Sid}, sku2_sid = #{sku2Sid}, bom_version_id = #{bomVersionId}, bom_version_date_get = #{bomVersionDateGet}, bom_version_name_get = #{bomVersionNameGet}, remark = #{remark}, creator_account = #{creatorAccount}, create_date = #{createDate}, updater_account = #{updaterAccount}, update_date = #{updateDate}, confirmer_account = #{confirmerAccount}, confirm_date = #{confirmDate}, data_source_sys = #{dataSourceSys},</trim> where product_cost_bom_sid = #{productCostBomSid}
  </update>  
  <!--更新多个-->  
  <update id="updatesAllById"> 
    <foreach collection="list" item="o" separator=";">update s_cos_product_cost_bom 
      <trim prefix="SET" suffixOverrides=",">client_id = #{clientId}, product_cost_sid = #{productCostSid}, bom_sid = #{bomSid}, material_sid = #{materialSid}, sku1_sid = #{sku1Sid}, sku2_sid = #{sku2Sid}, bom_version_id = #{bomVersionId}, bom_version_date_get = #{bomVersionDateGet}, bom_version_name_get = #{bomVersionNameGet}, remark = #{remark}, creator_account = #{creatorAccount}, create_date = #{createDate}, updater_account = #{updaterAccount}, update_date = #{updateDate}, confirmer_account = #{confirmerAccount}, confirm_date = #{confirmDate}, data_source_sys = #{dataSourceSys},</trim> where product_cost_bom_sid = #{productCostBomSid}
    </foreach> 
  </update> 
  <delete id="deleteProductBomAndMaterialByProductCostSid">
  	DELETE 
		t1,
		t2 
	FROM
		s_cos_product_cost_bom t1,
		s_cos_product_cost_material t2 
	WHERE
		t1.product_cost_bom_sid = t2.product_cost_bom_sid 
		AND t1.product_cost_sid = #{productCostSid}
  </delete>
</mapper>
