<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.platform.ems.mapper.BasMaterialSkuDownMapper">

    <resultMap type="com.platform.ems.domain.BasMaterialSkuDown" id="BasMaterialSkuDownResult">
        <result property="clientId"    column="client_id"    />
        <result property="materialSid"    column="material_sid"    />
        <result property="companySid"    column="company_sid"    />
        <result property="skuSid"    column="sku_sid"    />
        <result property="skuType"    column="sku_type"    />
        <result property="gramWeight"    column="gram_weight"    />
        <result property="remark"    column="remark"    />
        <result property="creatorAccount"    column="creator_account"    />
        <result property="createDate"    column="create_date"    />
        <result property="updaterAccount"    column="updater_account"    />
        <result property="updateDate"    column="update_date"    />
        <result property="dataSourceSys"    column="data_source_sys"    />
        <result property="skuCode"    column="sku_code"    />
        <result property="skuName"    column="sku_name"    />
    </resultMap>

    <sql id="selectBasMaterialSkuDownVo">
        select t.client_id, t.material_sid, t.company_sid, t.sku_sid, t.sku_type, t.gram_weight, t.remark, t.creator_account,
        t.create_date, t.updater_account, t.update_date, t.data_source_sys, t1.sku_code, t1.sku_name
        from s_bas_material_sku_down t
        LEFT JOIN s_bas_sku t1 ON t1.sku_sid = t.sku_sid
    </sql>

    <select id="selectBasMaterialSkuDownById" parameterType="Long" resultMap="BasMaterialSkuDownResult">
        <include refid="selectBasMaterialSkuDownVo"/>
        where t.client_id = #{clientId}
    </select>

    <sql id="selectForExternalList">
        select t.client_id,
               t.material_sku_down_sid,
               t.material_sid AS product_sid,
               t.company_sid,
               t.sku_sid AS sku_size_sid,
               t.sku_type,
               t.gram_weight,
               t.remark,
               t.creator_account,
               t.create_date,
               t.updater_account,
               t.update_date,
               t.data_source_sys,
               t1.sku_code AS sku_size_code,
               t1.sku_name AS sku_size_name
        from s_bas_material_sku_down t
        LEFT JOIN s_bas_sku t1 ON t1.sku_sid = t.sku_sid
    </sql>

    <select id="selectForExternalList" parameterType="long" resultType="com.platform.ems.domain.dto.response.external.BasMaterialSkuDownExternal">
    <include refid="selectForExternalList"/>
        <where>
            <if test="materialSid != null and materialSid != ''">
                and  t.material_sid  = #{materialSid}
            </if>
        </where>
    </select>

    <select id="selectBasMaterialSkuDownList" parameterType="com.platform.ems.domain.BasMaterialSkuDown" resultMap="BasMaterialSkuDownResult">
        <include refid="selectBasMaterialSkuDownVo"/>
        <where>
                                                        <if test="materialSid != null  and materialSid != ''">
        and  t.material_sid = #{materialSid}</if>
        <if test="companySid != null">
            and  t.company_sid = #{companySid}
        </if>
                                                                                                <if test="gramWeight != null  and gramWeight != ''">
        and  t.gram_weight in (
        <foreach collection="gramWeight.split(';')" item="item" separator=",">
        #{item}
        </foreach>
        )
        </if>
                                                                <if test="creatorAccount != null  and creatorAccount != ''">
        and  t.creator_account in (
        <foreach collection="creatorAccount.split(';')" item="item" separator=",">
        #{item}
        </foreach>
        )
        </if>
                                                                <if test="createDate != null "> and t.create_date = #{createDate}</if>
                                                                <if test="updaterAccount != null  and updaterAccount != ''">
        and  t.updater_account in (
        <foreach collection="updaterAccount.split(';')" item="item" separator=",">
        #{item}
        </foreach>
        )
        </if>
                                                                <if test="updateDate != null "> and t.update_date = #{updateDate}</if>
                                                                <if test="dataSourceSys != null  and dataSourceSys != ''">
        and  t.data_source_sys in (
        <foreach collection="dataSourceSys.split(';')" item="item" separator=",">
        #{item}
        </foreach>
        )
        </if>
                                        </where>
    </select>


    <!--添加多个-->
    <insert id="inserts">
        insert into s_bas_material_sku_down
        <trim prefix="(" suffix=")" suffixOverrides=",">
                        client_id,
                                material_sid,
                                company_sid,
                                sku_sid,
                                sku_type,
                                gram_weight,
                                remark,
                                status,
                                creator_account,
                                create_date,
                                updater_account,
                                update_date,
                                data_source_sys,
                        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
        <foreach collection="list" item="o" separator=",">
                        #{clientId},
                                #{materialSid},
                                #{companySid},
                                #{skuSid},
                                #{skuType},
                                #{gramWeight},
                                #{remark},
                                #{status},
                                #{creatorAccount},
                                #{createDate},
                                #{updaterAccount},
                                #{updateDate},
                                #{dataSourceSys},
                        </foreach>
        </trim>
    </insert>

    <!--更新-->
    <update id="updateAllById">
        update s_bas_material_sku_down
        <trim prefix="SET" suffixOverrides=",">
                                material_sid = #{materialSid},
                                company_sid = #{companySid},
                                sku_sid = #{skuSid},
                                sku_type = #{skuType},
                                gram_weight = #{gramWeight},
                                remark = #{remark},
                                status = #{status},
                                creator_account = #{creatorAccount},
                                create_date = #{createDate},
                                updater_account = #{updaterAccount},
                                update_date = #{updateDate},
                                data_source_sys = #{dataSourceSys},
                        </trim>
        where client_id = #{clientId}
    </update>

    <!--更新多个-->
    <update id="updatesAllById">
        <foreach collection="list" item="o" separator=";">
        update s_bas_material_sku_down
        <trim prefix="SET" suffixOverrides=",">
                                material_sid = #{materialSid},
                                company_sid = #{companySid},
                                sku_sid = #{skuSid},
                                sku_type = #{skuType},
                                gram_weight = #{gramWeight},
                                remark = #{remark},
                                status = #{status},
                                creator_account = #{creatorAccount},
                                create_date = #{createDate},
                                updater_account = #{updaterAccount},
                                update_date = #{updateDate},
                                data_source_sys = #{dataSourceSys},
                        </trim>
        where client_id = #{clientId}
        </foreach>
    </update>

    <delete id="deleteMaterialSkuDownById" parameterType="Long">
        delete from s_bas_material_sku_down where material_sid = #{materialSid}
    </delete>

    <delete id="deleteBasMaterialSkuDownByIds" parameterType="Long">
        delete from s_bas_material_sku_down where material_sid in
        <foreach item="materialSid" collection="list" open="(" separator="," close=")">
            #{materialSid}
        </foreach>
    </delete>
</mapper>
